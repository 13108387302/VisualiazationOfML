# æœºå™¨å­¦ä¹ å¯è§†åŒ–ç•Œé¢ - å¿«é€Ÿå‚è€ƒ

## ğŸš€ å¿«é€Ÿå¯åŠ¨

```bash
# å¯åŠ¨ä¸»ç¨‹åº
python main.py

# å¯åŠ¨æ¼”ç¤ºç¨‹åº
python demo.py

# æµ‹è¯•æ¨¡å—
python test_modules.py
```

## ğŸ“ é¡¹ç›®ç»“æ„é€Ÿè§ˆ

```
ml_visual/
â”œâ”€â”€ __init__.py           # æ¨¡å—å¯¼å‡º
â”œâ”€â”€ main_window.py        # ä¸»çª—å£ã€èœå•ã€æ–‡ä»¶ç®¡ç†
â”œâ”€â”€ canvas.py             # ç”»å¸ƒã€æ‹–æ‹½ã€è¿æ¥ç®¡ç†
â”œâ”€â”€ components.py         # ç»„ä»¶ã€ç«¯å£ã€è¿æ¥çº¿
â”œâ”€â”€ component_library.py  # ç»„ä»¶åº“ã€åˆ†ç±»ç®¡ç†
â”œâ”€â”€ property_panel.py     # å±æ€§é¢æ¿ã€åŠ¨æ€è¡¨å•
â””â”€â”€ utils.py              # å·¥å…·å‡½æ•°ã€åç«¯æ¥å£
```

## ğŸ”§ æ ¸å¿ƒç±»é€Ÿè§ˆ

### ä¸»è¦ç±»åŠå…¶èŒè´£
```python
MLVisualizationUI    # ä¸»çª—å£ï¼Œåè°ƒå„æ¨¡å—
MLCanvas            # ç”»å¸ƒï¼Œç®¡ç†ç»„ä»¶å’Œè¿æ¥
MLComponent         # MLç»„ä»¶åŸºç±»
ConnectionPort      # è¿æ¥ç«¯å£
ConnectionLine      # è¿æ¥çº¿
ComponentLibrary    # ç»„ä»¶åº“é¢æ¿
PropertyPanel       # å±æ€§é…ç½®é¢æ¿
WorkflowManager     # å·¥ä½œæµç¨‹ç®¡ç†
ExecutionEngine     # æ‰§è¡Œå¼•æ“(é¢„ç•™)
```

## ğŸ¯ å¸¸ç”¨å¼€å‘ä»»åŠ¡

### 1. æ·»åŠ æ–°ç»„ä»¶ç±»å‹

```python
# 1. æ³¨å†Œç»„ä»¶ (component_library.py)
self.component_types["æ–°ç»„ä»¶"] = "new_type"

# 2. é…ç½®ç«¯å£ (components.py)
port_config = {
    'new_type': {'inputs': 1, 'outputs': 1}
}

# 3. æ·»åŠ å±æ€§ (property_panel.py)
elif component.component_type == 'new_type':
    self.add_new_type_properties(component)

# 4. å®ç°æ‰§è¡Œ (utils.py)
def _execute_new_type_component(self, component):
    # æ‰§è¡Œé€»è¾‘
    return True
```

### 2. æ·»åŠ æ–°å±æ€§æ§ä»¶

```python
# åœ¨property_panel.pyä¸­æ‰©å±•
def _create_property_widget(self, prop_type, default_value):
    if prop_type == "CustomWidget":
        widget = CustomWidget(default_value)
        return widget
    # ç°æœ‰ä»£ç ...
```

### 3. æ·»åŠ èœå•åŠŸèƒ½

```python
# åœ¨main_window.pyä¸­æ·»åŠ 
def create_menu_bar(self):
    # ç°æœ‰èœå•...
    new_menu = menubar.addMenu('æ–°èœå•')
    new_action = new_menu.addAction('æ–°åŠŸèƒ½')
    new_action.triggered.connect(self.new_function)

def new_function(self):
    # å®ç°æ–°åŠŸèƒ½
    pass
```

## ğŸ“¡ ä¿¡å·æ§½è¿æ¥

### ä¸»è¦ä¿¡å·
```python
# Canvasä¿¡å·
component_selected = pyqtSignal(object)    # ç»„ä»¶é€‰æ‹©
component_added = pyqtSignal(object)       # ç»„ä»¶æ·»åŠ 
connection_created = pyqtSignal(object)    # è¿æ¥åˆ›å»º

# PropertyPanelä¿¡å·
property_changed = pyqtSignal(object, str, object)  # å±æ€§æ”¹å˜
```

### è¿æ¥ç¤ºä¾‹
```python
# åœ¨main_window.pyä¸­
self.canvas.component_selected.connect(self.on_component_selected)
self.property_panel.property_changed.connect(self.on_property_changed)
```

## ğŸ¨ ç»„ä»¶å¤–è§‚é…ç½®

### ç»„ä»¶é¢œè‰²
```python
colors = {
    'data': QColor(100, 150, 255),      # è“è‰²
    'preprocess': QColor(255, 200, 100), # æ©™è‰²
    'model': QColor(150, 255, 150),     # ç»¿è‰²
    'evaluate': QColor(255, 150, 150),  # çº¢è‰²
    'output': QColor(200, 200, 200)     # ç°è‰²
}
```

### ç«¯å£é…ç½®
```python
port_config = {
    'data': {'inputs': 0, 'outputs': 1},
    'preprocess': {'inputs': 1, 'outputs': 1},
    'model': {'inputs': 1, 'outputs': 1},
    'evaluate': {'inputs': 2, 'outputs': 1},
    'output': {'inputs': 1, 'outputs': 0}
}
```

## ğŸ’¾ æ•°æ®æ ¼å¼

### é¡¹ç›®æ–‡ä»¶(.mlv)
```json
{
  "components": [
    {
      "id": "comp_id",
      "type": "data",
      "name": "æ•°æ®åŠ è½½",
      "position": [100, 100],
      "properties": {"param": "value"}
    }
  ],
  "connections": [
    {
      "start_component": "comp1",
      "start_port": 0,
      "end_component": "comp2",
      "end_port": 0
    }
  ]
}
```

## ğŸ” è°ƒè¯•æŠ€å·§

### å¯ç”¨æ—¥å¿—
```python
import logging
logging.basicConfig(level=logging.DEBUG)
logger = logging.getLogger(__name__)
```

### ç»„ä»¶çŠ¶æ€å¯è§†åŒ–
```python
component.set_status("running")  # ready, running, completed, error
```

### è¿æ¥éªŒè¯
```python
def _validate_connection(self, start_port, end_port):
    # æ£€æŸ¥ç«¯å£ç±»å‹å…¼å®¹æ€§
    return start_port.port_type == end_port.port_type
```

## ğŸ§ª æµ‹è¯•å‘½ä»¤

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python -m unittest discover tests/

# è¿è¡Œç‰¹å®šæµ‹è¯•
python -m unittest tests.test_components
python -m unittest tests.test_workflow
python -m unittest tests.test_performance
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–è¦ç‚¹

### ç”»å¸ƒä¼˜åŒ–
```python
# å¯ç”¨ç¼“å­˜
self.setCacheMode(QGraphicsView.CacheBackground)

# ä¼˜åŒ–æ¸²æŸ“
self.setOptimizationFlags(
    QGraphicsView.DontSavePainterState |
    QGraphicsView.DontAdjustForAntialiasing
)
```

### å†…å­˜ç®¡ç†
```python
# ç»„ä»¶åˆ é™¤æ—¶æ¸…ç†èµ„æº
def remove_component(self, component):
    # æ¸…ç†ç«¯å£è¿æ¥
    # æ¸…ç†å›¾å½¢é¡¹
    # å¼ºåˆ¶åƒåœ¾å›æ”¶
    import gc
    gc.collect()
```

## ğŸ”Œ åç«¯é›†æˆæ¨¡æ¿

### Scikit-learné›†æˆ
```python
class SklearnExecutor:
    def execute_data_loader(self, config):
        data = pd.read_csv(config.properties['file_path'])
        return True, data
        
    def execute_random_forest(self, config, input_data):
        model = RandomForestClassifier(**config.properties)
        model.fit(*input_data)
        return True, model
```

### TensorFlowé›†æˆ
```python
class TensorFlowExecutor:
    def execute_neural_network(self, config, input_data):
        model = keras.Sequential([
            keras.layers.Dense(100, activation='relu'),
            keras.layers.Dense(1, activation='sigmoid')
        ])
        model.compile(optimizer='adam', loss='binary_crossentropy')
        model.fit(*input_data)
        return True, model
```

## ğŸ› ï¸ å¸¸ç”¨å·¥å…·å‡½æ•°

### ç»„ä»¶æŸ¥æ‰¾
```python
def find_component_by_name(canvas, name):
    for comp in canvas.components:
        if comp.name == name:
            return comp
    return None
```

### è¿æ¥æŸ¥æ‰¾
```python
def find_connections_for_component(canvas, component):
    connections = []
    for conn in canvas.connections:
        if (conn.start_port.parent_component == component or
            conn.end_port.parent_component == component):
            connections.append(conn)
    return connections
```

### å·¥ä½œæµç¨‹éªŒè¯
```python
def validate_workflow_quick(canvas):
    if not canvas.components:
        return False, "æ²¡æœ‰ç»„ä»¶"
    
    # æ£€æŸ¥æ˜¯å¦æœ‰æ•°æ®æº
    has_data_source = any(
        comp.component_type == 'data' for comp in canvas.components
    )
    if not has_data_source:
        return False, "ç¼ºå°‘æ•°æ®æºç»„ä»¶"
        
    return True, "éªŒè¯é€šè¿‡"
```

## ğŸ“‹ å¼€å‘æ£€æŸ¥æ¸…å•

### æ·»åŠ æ–°ç»„ä»¶æ—¶
- [ ] åœ¨component_library.pyä¸­æ³¨å†Œ
- [ ] åœ¨components.pyä¸­é…ç½®ç«¯å£
- [ ] åœ¨property_panel.pyä¸­æ·»åŠ å±æ€§
- [ ] åœ¨utils.pyä¸­å®ç°æ‰§è¡Œé€»è¾‘
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•
- [ ] æ›´æ–°æ–‡æ¡£

### æ·»åŠ æ–°åŠŸèƒ½æ—¶
- [ ] è®¾è®¡APIæ¥å£
- [ ] å®ç°æ ¸å¿ƒé€»è¾‘
- [ ] æ·»åŠ é”™è¯¯å¤„ç†
- [ ] ç¼–å†™æµ‹è¯•ç”¨ä¾‹
- [ ] æ›´æ–°ç”¨æˆ·æ–‡æ¡£
- [ ] æ€§èƒ½æµ‹è¯•

### å‘å¸ƒå‰æ£€æŸ¥
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡
- [ ] ä»£ç å®¡æŸ¥å®Œæˆ
- [ ] æ–‡æ¡£æ›´æ–°
- [ ] æ€§èƒ½æµ‹è¯•é€šè¿‡
- [ ] ç”¨æˆ·éªŒæ”¶æµ‹è¯•
- [ ] ç‰ˆæœ¬å·æ›´æ–°

---

ğŸ’¡ **æç¤º**: è¿™ä»½å¿«é€Ÿå‚è€ƒæ¶µç›–äº†æ—¥å¸¸å¼€å‘ä¸­æœ€å¸¸ç”¨çš„ä¿¡æ¯ã€‚è¯¦ç»†å†…å®¹è¯·å‚è€ƒã€Šå¼€å‘è€…æŒ‡å—.mdã€‹ã€‚
